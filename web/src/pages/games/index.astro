---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { ArrowRight } from 'lucide-react';
import { Image } from 'astro:assets';

const allGames = await getCollection('games');
// Filter for game index files (IDs that don't contain slashes, e.g. "chase-au-tresor")
const gameIndices = allGames.filter(game => !game.id.includes('/'));
---

<BaseLayout title="Games | Mrrakc" description="Explore our collection of interactive games and treasure hunts.">
  <section class="pt-32 pb-20 px-4 md:px-8 bg-sand dark:bg-[#1a1a1a] transition-colors duration-300 min-h-screen">
    <div class="max-w-7xl mx-auto">
      <div class="text-center mb-16">
        <h1 class="text-4xl md:text-5xl font-serif font-bold text-charcoal dark:text-stone-100 mb-4">
          Available Games
        </h1>
        <p class="text-lg text-charcoal-light dark:text-stone-400 max-w-2xl mx-auto">
          Choose an adventure and start exploring!
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {gameIndices.map(game => {
          const { title, description, heroImage } = game.data;
          const gameSlug = game.id.split('/')[0];
          
          return (
            <a href={`/games/${gameSlug}`} class="group block bg-white dark:bg-stone-800 rounded-2xl overflow-hidden shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1">
              {heroImage && (
                <div class="aspect-video overflow-hidden">
                  <Image src={heroImage} alt={title} class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500" />
                </div>
              )}
              <div class="p-6">
                <h2 class="text-2xl font-bold text-charcoal dark:text-stone-100 mb-3 group-hover:text-terra transition-colors">
                  {title}
                </h2>
                <p class="text-stone-600 dark:text-stone-300 mb-4 line-clamp-3">
                  {description}
                </p>
                <span class="inline-flex items-center text-terra font-bold group-hover:gap-2 transition-all">
                  Play Now <ArrowRight size={18} class="ml-1" />
                </span>
              </div>
            </a>
          );
        })}
      </div>
    </div>
  </section>
</BaseLayout>
